@page
@model TaskTracker.Pages.IndexModel
@{
    ViewData["Title"] = "TaskTracker Â· Tarefas";
}

<div class="row g-3 align-items-center mb-3">
  <div class="col-12 col-md-8">
    <form method="post" class="d-flex gap-2">
      <input asp-for="NewTask.Title" class="form-control form-control-lg" placeholder="Nova tarefa..." />
      <button class="btn btn-primary btn-lg" type="submit">Adicionar</button>
    </form>
    <span class="text-warning">@Html.ValidationMessage("NewTask.Title")</span>
  </div>
  <div class="col-12 col-md-4">
    <form method="get" class="input-group">
      <input name="search" value="@Model.Search" class="form-control" placeholder="Buscar..." />
      <input type="hidden" name="filter" value="@Model.Filter" />
      <button class="btn btn-outline-light" type="submit">OK</button>
    </form>
  </div>
</div>

<ul class="nav nav-pills mb-3">
  <li class="nav-item">
    <a class="nav-link @(Model.Filter=="all"?"active":"")" href="/?filter=all&search=@Model.Search">Todas <span class="badge bg-secondary">@Model.CountAll</span></a>
  </li>
  <li class="nav-item">
    <a class="nav-link @(Model.Filter=="todo"?"active":"")" href="/?filter=todo&search=@Model.Search">Pendentes <span class="badge bg-secondary">@Model.CountTodo</span></a>
  </li>
  <li class="nav-item">
    <a class="nav-link @(Model.Filter=="done"?"active":"")" href="/?filter=done&search=@Model.Search">ConcluÃ­das <span class="badge bg-secondary">@Model.CountDone</span></a>
  </li>
</ul>

@if (!Model.Tasks.Any())
{
    <div class="alert alert-secondary">Nada por aqui. Adicione uma tarefa! ðŸ‘‡</div>
}

<div class="list-group">
@foreach (var task in Model.Tasks)
{
  <div class="list-group-item bg-dark text-light border-secondary d-flex justify-content-between align-items-center">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" @(task.IsDone ? "checked" : "") onchange="location.href='/?toggle=@task.Id&filter=@Model.Filter&search=@Model.Search'">
      <label class="form-check-label @(task.IsDone?"text-decoration-line-through text-secondary":"")">
        @task.Title
      </label>
    </div>
    <a class="btn btn-sm btn-outline-danger" href="/?delete=@task.Id&filter=@Model.Filter&search=@Model.Search">Excluir</a>
  </div>
}
</div>
